<div class="wrap">
  <header class="header">
    <div class="brand">
      <div class="logo">AI</div>
      <div class="title">
        <strong>Assistente</strong>
        <span class="status">
          <ng-container *ngIf="busy; else onlineTpl">
            <span class="spinner" aria-hidden="true"></span>
            <span class="status-text">Digitandoâ€¦</span>
          </ng-container>

          <ng-template #onlineTpl>
            <span class="dot" aria-hidden="true"></span>
            <span class="status-text">Online</span>
          </ng-template>
        </span>
      </div>
    </div>

    <div class="header-actions" *ngIf="whatsAppLink && humanWhatsapp === 'yes'">
      <!-- BotÃ£o WhatsApp compacto -->
      <button class="wabtn" type="button" (click)="openWhatsApp()" aria-label="Abrir WhatsApp">
        <span class="wa-ic" aria-hidden="true">ðŸ’¬</span>
        <span class="wa-label">WhatsApp</span>
      </button>

      <!-- Texto premium (sempre visÃ­vel em desktop) -->
      <span class="wa-note" title="Atendimento humano (se disponÃ­vel)">
        Atendimento humano (se disponÃ­vel)
      </span>

      <!-- Tooltip icon (melhor para mobile) -->
      <span class="wa-info" aria-label="InformaÃ§Ã£o" tabindex="0">
        i
        <span class="wa-tip">Atendimento humano (se disponÃ­vel)</span>
      </span>
    </div>

    <button class="xbtn" (click)="close()" type="button" aria-label="Fechar">âœ•</button>
  </header>

  <main id="msgs" class="messages">
    <div *ngFor="let m of messages" class="bubble" [class.me]="m.role === 'user'" [class.bot]="m.role === 'assistant'">
      {{ m.text }}
    </div>
    <div *ngIf="busy" class="bubble bot typing-bubble" aria-label="Assistente digitando">
      <span class="typing" aria-hidden="true">
        <i></i><i></i><i></i>
      </span>
    </div>
  </main>

  <footer class="footer">
    <input class="input" [(ngModel)]="input" [disabled]="busy" (keydown.enter)="send()"
      placeholder="Escreva a sua mensagemâ€¦" />
    <button class="send" (click)="send()" [disabled]="busy" type="button">Enviar</button>
  </footer>
</div>